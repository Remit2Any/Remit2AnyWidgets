{"version":3,"file":"hv-kyc.mjs","sources":["../../../projects/hv-kyc/src/lib/hv-kyc-model.ts","../../../projects/hv-kyc/src/lib/script.service.ts","../../../projects/hv-kyc/src/lib/hv-kyc.component.ts","../../../projects/hv-kyc/src/lib/hv-kyc.component.html","../../../projects/hv-kyc/src/lib/hv-kyc.module.ts","../../../projects/hv-kyc/src/public-api.ts","../../../projects/hv-kyc/src/hv-kyc.ts"],"sourcesContent":["\ninterface Common {\n    status: string;\n    statusCode: number;\n}\n\ninterface Message {\n    message: string;\n    description?: string;\n}\n\nexport interface KYCInitiate{\n    kycUniqueReferenceId: string;\n    token: string;\n}\nexport enum KYCStatus {\n  // Not started before\n  not_started = \"not_started\",\n  // started\n  started = \"started\",\n  // KYC verification issue\n  user_cancelled  = \"user_cancelled\",\n  error = \"error\",\n\n  // No actions from user, Waiting on us to review and verify\n  needs_review = \"needs_review\",\n\n  // Manual approval steps\n  manually_approved = \"manually_approved\",\n  auto_approved = \"auto_approved\",\n\n  // Start KYC process again\n  manually_declined = \"manually_declined\",\n  auto_declined = \"auto_declined\"\n}\n\nexport interface KYCInquiryResponse extends Common {\n    userId: string\n    kycStatus: KYCStatus\n}\n\nexport interface KYCDetail{\n    details: any;\n    userID: string;\n    transactionId: string;\n    status: string\n}\n\nexport interface KYCProcess extends KYCInquiryResponse{}\n\nexport interface KYCInputs {\n    kycUniqueReferenceId: string;\n    authToken: string;\n    label?: string;\n    cssClassNames?: string;\n}","import { Renderer2, Inject, Injectable } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ScriptService {\n\n  constructor(\n    @Inject(DOCUMENT) private document: Document\n  ) { }\n\n /**\n  * Append the JS tag to the Document Body.\n  * @param renderer The Angular Renderer\n  * @param src The path to the script\n  * @returns the script element\n  */\n  public loadJsScript(renderer: Renderer2, src: string): HTMLScriptElement {\n    const script = renderer.createElement('script');\n    script.type = 'text/javascript';\n    script.src = src;\n    renderer.appendChild(this.document.body, script);\n    return script;\n  }\n}","import {\n  ChangeDetectorRef,\n  Component,\n  Input,\n  OnInit,\n  Output,\n  Renderer2,\n  TemplateRef,\n  ViewChild,\n} from '@angular/core';\nimport {\n  KYCInitiate,\n  KYCInputs,\n  KYCInquiryResponse,\n  KYCProcess,\n  KYCStatus,\n} from './hv-kyc-model';\nimport { ScriptService } from './script.service';\n\nconst SCRIPT_PATH = 'https://hv-camera-web-sg.s3-ap-southeast-1.amazonaws.com/hyperverge-web-sdk@5.2.8/src/sdk.min.js';\n\ndeclare var window: any;\n@Component({\n  selector: 'remit2any-hv-kyc',\n  templateUrl: './hv-kyc.component.html',\n  styleUrls: ['./hv-kyc.component.scss'],\n})\nexport class HvKycComponent implements OnInit {\n[x: string]: any;\n  private kycStep: KYCStatus | undefined;\n  public kycBtn: boolean = false;\n  public KYCStatus = KYCStatus;\n  @ViewChild('not_started') not_started: TemplateRef<any> | undefined;\n  @ViewChild('started') started: TemplateRef<any> | undefined;\n  @ViewChild('user_cancelled') user_cancelled: TemplateRef<any> | undefined;\n  @ViewChild('auto_approved') auto_approved: TemplateRef<any> | undefined;\n  @ViewChild('manually_approved') manually_approved: TemplateRef<any> | undefined;\n  @ViewChild('needs_review') needs_review: TemplateRef<any> | undefined;\n  @ViewChild('error') error: TemplateRef<any> | undefined;\n  @ViewChild('auto_declined') auto_declined: TemplateRef<any> | undefined;\n  @ViewChild('manually_declined') manually_declined: TemplateRef<any> | undefined;\n\n  @Input() onSuccess: (args: any) => void = () => { console.log(\"default implementation\") };\n  @Input() onFailure: (args: any) => void = () => {console.log(\"default implementation\")};\n\n  @Input() kycInputs!: KYCInputs;\n\n  public serverError: boolean = false;\n  public serverErrorMessage: string | undefined;\n  constructor(\n    private readonly _changeDetectorRef: ChangeDetectorRef,\n    private renderer: Renderer2,\n    private scriptService: ScriptService\n  ) { }\n\n  ngOnInit() {\n    const scriptElement = this.scriptService.loadJsScript(this.renderer, SCRIPT_PATH);\n  }\n\n  goBack(value: KYCStatus) {\n    this.kycStep = value;\n    this.kycBtn = false;\n  }\n\n  public startKYCProcess(token: string, kycUniqueReferenceId: string) {\n    this.launchHyperVerge(token, kycUniqueReferenceId);\n  }\n\n  private setStateKYC(response: any) {\n    this.kycStep = response.kycStatus;\n    this.kycBtn = false;\n    switch (this.kycStep) {\n      case KYCStatus.manually_approved:\n        this.kycBtn = true;\n        break;\n      case KYCStatus.auto_approved:\n        this.kycBtn = true;\n        break;\n    }\n  }\n\n  private kycWidgetHandler = (HyperKycResult: any) => {\n\n      if (HyperKycResult.status === \"user_cancelled\") {\n        this.onFailure(HyperKycResult);\n      }\n\n      // Some error with the flow like token expired\n      if (HyperKycResult.status === \"error\") {\n        this.onFailure(HyperKycResult);\n      }\n\n      // Auto approved\n      if (HyperKycResult.status === \"auto_approved\") {\n          this.onSuccess(HyperKycResult);\n      }\n  };\n\n  private launchHyperVerge(token: string, uuid: string) {\n    // @ts-ignore\n    const hyperKycConfig = new HyperKycConfig(\n      token,\n      'digilocker-DBcheck',\n      uuid\n    );\n    window.HyperKYCModule.launch(hyperKycConfig, this.kycWidgetHandler);\n  }\n}\n","<button type=\"button\"\n  (click)=\"startKYCProcess(kycInputs.authToken, kycInputs.kycUniqueReferenceId)\"\n  [class]=\"kycInputs.cssClassNames\"\n  >\n\n  {{kycInputs.label}}\n</button>\n","import { NgModule } from '@angular/core';\nimport { HvKycComponent } from './hv-kyc.component';\nimport { CommonModule } from '@angular/common';\n\n\n\n@NgModule({\n  declarations: [\n    HvKycComponent\n  ],\n  imports: [\n    CommonModule\n  ],\n  exports: [\n    HvKycComponent\n  ]\n})\nexport class HvKycModule { }\n","/*\n * Public API Surface of hv-kyc\n */\n\nexport * from './lib/hv-kyc.component';\nexport * from './lib/hv-kyc.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i1.ScriptService"],"mappings":"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"}